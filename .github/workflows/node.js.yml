name: Build React Native Android App

on:
  # Define when the workflow should be triggered (e.g., on pushes to the main branch)
  push:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest  # Replace with your preferred OS (adjust if needed)

    steps:
      - uses: actions/checkout@v3  # Checkout code from repository

      - name: Install Node.js (if needed)
        # Only add this step if you don't have Node.js installed locally
        uses: actions/setup-node@v3
        with:
          node-version: 18  # Adjust Node.js version to 18 (or compatible)

      - name: Install dependencies
        run: npm install  # Or yarn install

      # Ensure JRE version 11 or higher is available
      - name: Check JRE version
        run: |
          java -version
          if [[ $? -ne 0 ]]; then
            echo "WARNING: Java not found. Please install a JRE version 11 or higher."
          fi

      # Download & install the Android SDK.
      - uses: malinskiy/action-android/install-sdk@release/0.1.6  # Consider a CI/CD platform with pre-configured runners

      # Verify $ANDROID_HOME is properly set for later Gradle commands.
      - run: echo $ANDROID_HOME  # Print ANDROID_HOME for verification

      # (Optional) Additional verification for adb (if needed)
      - name: Verify adb functionality
        run: |
          which adb  # Check if adb is in the PATH
          if [[ $? -ne 0 ]]; then
            echo "WARNING: adb not found in PATH. Functionality might be limited."
          else
            adb devices  # Optional: Check for connected devices
          fi

      # Build the Android app
      - name: Run Android build
        run: npm run android:release  # Adjust command based on your project

      # (Optional) Upload AAB artifact
      - uses: actions/upload-artifact@v3
        with:
          name: android-release.aab  # Adjust file name if needed
          path: android/app/build/outputs/bundle/release/app-release.aab  # Adjust path based on your project

